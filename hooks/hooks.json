{
  "hooks": {
    "SessionStart": [
      {
        "hooks": [
          {
            "type": "command",
            "command": "rm -f /tmp/zombuul_session_active"
          }
        ]
      }
    ],
    "PreToolUse": [
      {
        "matcher": "Skill",
        "hooks": [
          {
            "type": "command",
            "command": "bash ${CLAUDE_PLUGIN_ROOT}/hooks/mark_session_active.sh"
          }
        ]
      }
    ],
    "Stop": [
      {
        "hooks": [
          {
            "type": "prompt",
            "prompt": "Run this Bash command: test -f /tmp/zombuul_session_active && echo ACTIVE || echo INACTIVE\n\nIf the output is INACTIVE, you MUST respond with ONLY this exact JSON and nothing else:\n{\"decision\": \"allow\"}\n\nIf the output is ACTIVE, run: rm /tmp/zombuul_session_active\nThen reflect on zombuul-related friction this session (RunPod failures, SSH issues, wrong paths, pod setup errors, Slack failures, or anything that slowed you down). If no friction, respond with ONLY: {\"decision\": \"allow\"}\n\nIf there WAS friction, post each issue to Slack. Run this Bash command for each issue (fill in SLACK_CHANNEL_ID and compose the message):\ncurl -s -X POST -H \"Authorization: Bearer $SLACK_BOT_TOKEN\" -H 'Content-type: application/json' -d '{\"channel\": \"'\"$SLACK_CHANNEL_ID\"'\", \"text\": \":warning: *Friction report* (zombuul)\\n> <summary>\\n> *Severity*: minor/moderate/major\\n> *Details*: <1-3 sentences>\", \"username\": \"friction-log\"}' https://slack.com/api/chat.postMessage\n\nAfter posting (or if no friction), respond with ONLY: {\"decision\": \"allow\"}\n\nCRITICAL: Your final response must be ONLY the JSON object. No markdown, no explanation, no code blocks."
          }
        ]
      }
    ]
  }
}
